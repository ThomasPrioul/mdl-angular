<div class="px-4 py-8 sm:px-6 lg:px-8">
  <a routerLink="/auth" class="text-blue-600 hover:underline mb-4 inline-block">
    â† Retour Ã  la dÃ©mo d'authentification
  </a>
  <div class="max-w-3xl mx-auto">
    <div class="bg-red-50 border border-red-200 rounded-lg p-6 mb-8">
      <div class="flex">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"
              clip-rule="evenodd"
            />
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-red-800">ğŸ”’ Page ProtÃ©gÃ©e</h3>
          <div class="mt-2 text-sm text-red-700">
            <p>
              FÃ©licitations ! Vous Ãªtes sur une page accessible uniquement aux utilisateurs
              authentifiÃ©s.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="bg-white shadow rounded-lg p-6 mb-8">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">ğŸ‘¤ Informations Utilisateur</h2>

      @if (user()) {
        <div class="space-y-4">
          <div class="bg-green-50 rounded-md p-4">
            <h3 class="text-sm font-medium text-green-900 mb-3">âœ… Utilisateur connectÃ©</h3>
            <div class="bg-white rounded p-3 border">
              <pre class="text-xs text-green-800 overflow-x-auto">{{ user() | json }}</pre>
            </div>
          </div>

          @if (accessToken()) {
            <div class="bg-blue-50 rounded-md p-4">
              <h3 class="text-sm font-medium text-blue-900 mb-2">ğŸ« Token d'accÃ¨s</h3>
              <p class="text-xs text-blue-800 break-all font-mono bg-white p-2 rounded border">
                {{ accessToken() || '' }}
              </p>
            </div>
          }

          <div class="flex space-x-4">
            <button
              (click)="logout()"
              class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors"
            >
              ğŸšª Se dÃ©connecter
            </button>

            <button
              (click)="checkAuth()"
              class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors"
            >
              ğŸ” VÃ©rifier l'authentification
            </button>
          </div>

          @if (authStatus !== null) {
            <div class="bg-gray-50 rounded-md p-4">
              <h3 class="text-sm font-medium text-gray-900 mb-2">ğŸ“Š Statut d'authentification</h3>
              <p
                class="text-sm"
                [class.text-green-600]="authStatus"
                [class.text-red-600]="!authStatus"
              >
                {{ authStatus ? 'âœ… Token valide et actif' : 'âŒ Token invalide ou expirÃ©' }}
              </p>
            </div>
          }
        </div>
      } @else {
        <div class="bg-yellow-50 rounded-md p-4">
          <h3 class="text-sm font-medium text-yellow-900 mb-2">â³ Chargement...</h3>
          <p class="text-sm text-yellow-800">
            RÃ©cupÃ©ration des informations utilisateur en cours...
          </p>
        </div>
      }
    </div>

    <div class="bg-white shadow rounded-lg p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">ğŸ›¡ï¸ Protection de cette page</h2>
      <div class="space-y-4">
        <div class="bg-gray-50 rounded-md p-4">
          <h3 class="text-sm font-medium text-gray-900 mb-2">Guard restrictedAccessGuard</h3>
          <p class="text-sm text-gray-600">
            Cette page est protÃ©gÃ©e par le guard <code>restrictedAccessGuard</code> qui :
          </p>
          <ul class="mt-2 text-sm text-gray-600 space-y-1">
            <li>â€¢ VÃ©rifie si l'utilisateur a un token valide</li>
            <li>â€¢ Redirige vers la page de connexion si nÃ©cessaire</li>
            <li>â€¢ Permet l'accÃ¨s seulement aprÃ¨s authentification</li>
            <li>â€¢ Redirige vers cette page aprÃ¨s connexion rÃ©ussie</li>
          </ul>
        </div>

        <div class="bg-blue-50 rounded-md p-4">
          <h3 class="text-sm font-medium text-blue-900 mb-2">Configuration dans les routes</h3>
          <p class="text-sm text-blue-800">
            path: 'protected' + canActivate: [restrictedAccessGuard]
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
